<!DOCTYPE html>
<html>
<head>
  <title>Wingo Diamond Pattern Finder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      background: linear-gradient(135deg, #f7fafc 0%, #dbeafe 100%);
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    .card {
      max-width: 380px;
      margin: 36px auto;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 6px 28px rgba(0,0,0,0.08);
      padding: 28px 20px 22px 20px;
      display: none;
      flex-direction: column;
      align-items: center;
      transition: box-shadow 0.2s;
      position: relative;
    }
    .card.active { display: flex; }
    h2 {
      margin-bottom: 22px;
      font-weight: 700;
      font-size: 1.4em;
      letter-spacing: 1px;
      color: #1e293b;
    }
    .vip-badge {
      position: absolute;
      top: 18px;
      right: 18px;
      background: linear-gradient(90deg, #fbbf24 70%, #f59e42 100%);
      color: #fff;
      font-weight: bold;
      font-size: 1em;
      border-radius: 8px;
      padding: 4px 14px;
      box-shadow: 0 2px 8px rgba(251,191,36,0.15);
      letter-spacing: 1px;
      display: none;
      align-items: center;
      gap: 6px;
      z-index: 2;
      animation: vip-pop 0.7s cubic-bezier(.68,-0.55,.27,1.55);
    }
    .vip-badge.active { display: flex; }
    .vip-badge svg {
      width: 20px;
      height: 20px;
      vertical-align: middle;
    }
    @keyframes vip-pop {
      0% { transform: scale(0.7);}
      80% { transform: scale(1.11);}
      100% { transform: scale(1);}
    }
    .free-timer {
      background: #fffbe6;
      color: #d97706;
      border-radius: 8px;
      padding: 7px 13px;
      font-size: 1.08em;
      font-weight: 600;
      margin-bottom: 12px;
      display: none;
      text-align: center;
      box-shadow: 0 1px 3px rgba(251,191,36,0.08);
    }
    .color-row {
      display: flex;
      gap: 28px;
      margin-bottom: 18px;
    }
    .color-btn {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      border: none;
      outline: none;
      font-size: 1.1em;
      font-weight: 700;
      color: #fff;
      box-shadow: 0 2px 10px rgba(30,41,59,0.08);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: transform 0.1s, box-shadow 0.2s;
      background: linear-gradient(135deg, #ef4444 60%, #b91c1c 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      animation: popin 0.6s cubic-bezier(.68,-0.55,.27,1.55);
    }
    .color-btn.green {
      background: linear-gradient(135deg, #22c55e 60%, #15803d 100%);
    }
    .color-btn:active {
      transform: scale(0.96);
      box-shadow: 0 1px 4px rgba(30,41,59,0.08);
    }
    @keyframes popin {
      0% { transform: scale(0.7);}
      80% { transform: scale(1.07);}
      100% { transform: scale(1);}
    }
    .results-bubble {
      background: #f1f5f9;
      border-radius: 14px;
      padding: 10px 14px;
      font-size: 1.09em;
      color: #334155;
      min-height: 32px;
      margin-bottom: 18px;
      width: 100%;
      text-align: center;
      letter-spacing: 0.3px;
      box-shadow: 0 1px 3px rgba(30,41,59,0.04);
      transition: background 0.2s;
      word-break: break-all;
    }
    .button-row {
      display: flex;
      gap: 12px;
      width: 100%;
      margin-bottom: 18px;
    }
    .analyze-btn, .remove-btn {
      flex: 1;
      padding: 13px 0;
      border: none;
      border-radius: 9px;
      font-size: 1.08em;
      font-weight: 600;
      letter-spacing: 0.5px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(37,99,235,0.08);
      transition: background 0.15s, transform 0.08s;
    }
    .analyze-btn {
      background: linear-gradient(90deg, #2563eb 70%, #1e40af 100%);
      color: #fff;
    }
    .analyze-btn:active {
      background: #1e40af;
      transform: scale(0.98);
    }
    .remove-btn {
      background: linear-gradient(90deg, #f87171 70%, #b91c1c 100%);
      color: #fff;
    }
    .remove-btn:active {
      background: #b91c1c;
      transform: scale(0.98);
    }
    .output-area {
      background: #e0f2fe;
      border-radius: 10px;
      padding: 12px 14px;
      font-size: 1em;
      color: #075985;
      min-height: 34px;
      text-align: center;
      box-shadow: 0 1px 3px rgba(7,89,133,0.06);
      width: 100%;
      margin-bottom: 2px;
      transition: background 0.2s;
    }
    .modal-bg {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(30,41,59,0.18);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    .modal {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 6px 24px rgba(30,41,59,0.11);
      padding: 28px 22px 18px 22px;
      text-align: center;
      max-width: 340px;
      width: 90vw;
      animation: popin 0.55s;
    }
    .modal input {
      width: 90%;
      padding: 10px 10px;
      border-radius: 7px;
      border: 1.5px solid #dbeafe;
      margin-bottom: 14px;
      font-size: 1.03em;
      outline: none;
      transition: border 0.18s;
    }
    .modal input:focus {
      border: 1.5px solid #2563eb;
    }
    .modal button {
      background: linear-gradient(90deg, #2563eb 70%, #1e40af 100%);
      color: #fff;
      border: none;
      border-radius: 7px;
      padding: 10px 28px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      margin-top: 6px;
      margin-bottom: 2px;
      transition: background 0.15s;
    }
    .modal button:active {
      background: #1e40af;
    }
    .modal .error {
      color: #ef4444;
      font-size: 0.98em;
      margin-bottom: 6px;
      margin-top: 2px;
      min-height: 20px;
    }
    #telegram-float {
      position: fixed;
      bottom: 22px;
      right: 22px;
      z-index: 1000;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      box-shadow: 0 4px 16px rgba(34,158,217,0.18);
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.18s, box-shadow 0.18s;
      animation: tg-pop 0.7s cubic-bezier(.68,-0.55,.27,1.55);
    }
    #telegram-float:hover {
      transform: scale(1.08);
      box-shadow: 0 8px 24px rgba(34,158,217,0.28);
    }
    @keyframes tg-pop {
      0% { transform: scale(0.7);}
      80% { transform: scale(1.11);}
      100% { transform: scale(1);}
    }
    #telegram-float svg {
      display: block;
    }
    @media (max-width: 480px) {
      .card { padding: 16px 4vw 18px 4vw; }
      .color-row { gap: 12vw; }
      .color-btn { width: 20vw; height: 20vw; min-width: 54px; min-height: 54px; }
      .button-row { flex-direction: column; gap: 10px; }
    }
  </style>
</head>
<body>
  <!-- Modal for Key Entry -->
  <div class="modal-bg" id="modalBg">
    <div class="modal">
      <h2>Enter Access Key</h2>
      <input type="password" id="accessKey" placeholder="Enter your key..." autocomplete="off" />
      <div class="error" id="keyError"></div>
      <button id="submitKey">Unlock</button>
    </div>
  </div>
  <div class="card" id="mainCard">
    <span class="vip-badge" id="vipBadge">
      <svg fill="none" viewBox="0 0 24 24"><path fill="#fff" d="M12 2l2.09 6.26L20 9.27l-5 3.64L16.18 20 12 16.77 7.82 20 9 12.91l-5-3.64 5.91-.91L12 2z"/></svg>
      VIP
    </span>
    <div class="free-timer" id="freeTimer"></div>
    <h2>Wingo Diamond Pattern Finder</h2>
    <div class="color-row">
      <button class="color-btn" id="redBox" aria-label="Add Red">Red</button>
      <button class="color-btn green" id="greenBox" aria-label="Add Green">Green</button>
    </div>
    <div class="results-bubble" id="results">No results yet</div>
    <div class="button-row">
      <button class="analyze-btn" id="analyzeBtn">Analyze Diamond Pattern</button>
      <button class="remove-btn" id="removeBtn">Remove Last Result</button>
    </div>
    <div class="output-area" id="output"></div>
  </div>
  <!-- Telegram Floating Button -->
  <a href="https://t.me/+Oo_acK0HYnZkZjE1" target="_blank" id="telegram-float" aria-label="Join on Telegram">
    <svg width="36" height="36" viewBox="0 0 16 16" fill="none">
      <circle cx="8" cy="8" r="8" fill="#229ED9"/>
      <path d="M12.79 4.21a.5.5 0 0 1 .17.51l-1.3 6.06c-.09.42-.34.52-.68.33l-1.88-1.39-.91.88c-.1.1-.18.18-.36.18l.13-1.85 3.37-3.05c.15-.13-.03-.2-.24-.07l-4.17 2.63-1.8-.56c-.39-.12-.4-.39.08-.58l7.02-2.7c.33-.12.62.08.5.5z" fill="#fff"/>
    </svg>
  </a>
  <script>
    // Utility: Generate a random device ID and store in localStorage
    function getDeviceId() {
      let deviceId = localStorage.getItem("wingo_device_id");
      if (!deviceId) {
        deviceId = "DEV-" + Math.random().toString(36).substr(2, 12);
        localStorage.setItem("wingo_device_id", deviceId);
      }
      return deviceId;
    }
    function setFreeKeyUsage(ip) {
      const deviceId = getDeviceId();
      const now = Date.now();
      localStorage.setItem("wingo_freekey_usage", JSON.stringify({
        deviceId,
        ip,
        timestamp: now
      }));
    }
    function getFreeKeyUsage() {
      try {
        return JSON.parse(localStorage.getItem("wingo_freekey_usage") || "{}");
      } catch {
        return {};
      }
    }
    function fetchIpAddress(callback) {
      fetch("https://api.ipify.org?format=json")
        .then(res => res.json())
        .then(data => callback(data.ip))
        .catch(() => callback("UNKNOWN"));
    }
    // Timer display for free key
    function formatTime(ms) {
      let total = Math.floor(ms / 1000);
      let h = Math.floor(total / 3600);
      let m = Math.floor((total % 3600) / 60);
      let s = total % 60;
      return `${h.toString().padStart(2,0)}:${m.toString().padStart(2,0)}:${s.toString().padStart(2,0)}`;
    }
    function showFreeTimer(expiry) {
      const freeTimer = document.getElementById('freeTimer');
      freeTimer.style.display = 'block';
      function update() {
        let now = Date.now();
        let left = expiry - now;
        if (left > 0) {
          freeTimer.textContent = "FREE KEY TIME LEFT: " + formatTime(left);
        } else {
          freeTimer.textContent = "FREE KEY EXPIRED!";
          setTimeout(() => {
            mainCard.classList.remove("active");
            vipBadge.classList.remove("active");
            freeTimer.style.display = 'none';
            modalBg.style.display = "flex";
            keyError.textContent = "FREE key expired. You cannot use it again for 24 hours.";
          }, 1500);
          clearInterval(timerInterval);
        }
      }
      update();
      var timerInterval = setInterval(update, 1000);
    }

    // Modal and unlock logic
    const modalBg = document.getElementById('modalBg');
    const accessKeyInput = document.getElementById('accessKey');
    const keyError = document.getElementById('keyError');
    const submitKey = document.getElementById('submitKey');
    const mainCard = document.getElementById('mainCard');
    const vipBadge = document.getElementById('vipBadge');
    const freeTimer = document.getElementById('freeTimer');
    let mode = "free"; // "free" or "vip"

    // Hide main UI and VIP badge initially
    mainCard.classList.remove("active");
    vipBadge.classList.remove("active");

    function unlockApp() {
      keyError.textContent = "";
      submitKey.disabled = true;
      const key = accessKeyInput.value.trim().toUpperCase();
      if (key === "FREEHACK") {
        fetchIpAddress(function(ip) {
          const usage = getFreeKeyUsage();
          const deviceId = getDeviceId();
          const now = Date.now();
          const DAY_MS = 24 * 60 * 60 * 1000;
          if (
            usage.deviceId === deviceId &&
            usage.ip === ip &&
            usage.timestamp &&
            now - usage.timestamp < DAY_MS
          ) {
            // Show timer if still valid, else block
            let expiry = usage.timestamp + DAY_MS;
            if (now < expiry) {
              mode = "free";
              modalBg.style.display = "none";
              mainCard.classList.add("active");
              vipBadge.classList.remove("active");
              showFreeTimer(expiry);
              submitKey.disabled = false;
            } else {
              keyError.textContent = "FREE key expired. You cannot use it again for 24 hours.";
              submitKey.disabled = false;
            }
          } else {
            setFreeKeyUsage(ip);
            mode = "free";
            modalBg.style.display = "none";
            mainCard.classList.add("active");
            vipBadge.classList.remove("active");
            showFreeTimer(now + DAY_MS);
            submitKey.disabled = false;
          }
        });
      } else if (key === "VIPKEY") {
        mode = "vip";
        modalBg.style.display = "none";
        mainCard.classList.add("active");
        vipBadge.classList.add("active");
        freeTimer.style.display = 'none';
        submitKey.disabled = false;
      } else {
        keyError.textContent = "Invalid key. Please try again.";
        submitKey.disabled = false;
      }
    }
    submitKey.onclick = unlockApp;
    accessKeyInput.addEventListener("keyup", function(e){
      if(e.key === "Enter") unlockApp();
    });

    // Main App Logic
    const redBox = document.getElementById('redBox');
    const greenBox = document.getElementById('greenBox');
    const resultsDiv = document.getElementById('results');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const removeBtn = document.getElementById('removeBtn');
    const outputDiv = document.getElementById('output');
    let resultsArr = [];

    function updateResultsDisplay() {
      resultsDiv.textContent = resultsArr.length ? resultsArr.join(', ') : "No results yet";
    }
    function addColor(color) {
      if (resultsArr.length >= 8) resultsArr = resultsArr.slice(1);
      resultsArr.push(color);
      updateResultsDisplay();
      outputDiv.innerHTML = "";
    }
    function removeLastResult() {
      if (resultsArr.length) {
        resultsArr.pop();
        updateResultsDisplay();
        outputDiv.innerHTML = "";
      }
    }
    redBox.addEventListener('click', () => addColor('Red'));
    greenBox.addEventListener('click', () => addColor('Green'));
    removeBtn.addEventListener('click', removeLastResult);

    analyzeBtn.addEventListener('click', function() {
      if (resultsArr.length < 5) {
        outputDiv.innerHTML = "Please enter at least 5 results for analysis.";
        return;
      }
      // Diamond pattern check (same for both modes)
      let diamond = false;
      if (resultsArr.length >= 5) {
        if (resultsArr[0] === resultsArr[4] && resultsArr[1] === resultsArr[3]) diamond = true;
      }
      let output = diamond
        ? "<b>Diamond pattern detected!</b><br>"
        : "No clear diamond pattern detected.<br>";

      // Prediction logic
      let prediction = "Unknown";
      if (mode === "free") {
        // Basic: most frequent color
        let freq = {};
        resultsArr.forEach(r => freq[r] = (freq[r] || 0) + 1);
        let sorted = Object.entries(freq).sort((a, b) => b[1] - a[1]);
        prediction = sorted.length > 0 ? sorted[0][0] : "Unknown";
        output += "Most frequent result: <b>" + prediction + "</b><br>";
        output += "Next result prediction (based on frequency): <b>" + prediction + "</b>";
      } else {
        // VIP: frequency + last two pattern logic
        let freq = {};
        resultsArr.forEach(r => freq[r] = (freq[r] || 0) + 1);
        let sorted = Object.entries(freq).sort((a, b) => b[1] - a[1]);
        let mostFreq = sorted.length > 0 ? sorted[0][0] : "Unknown";
        // If last two are same, predict switch, else use most frequent
        if (resultsArr.length >= 2 && resultsArr[resultsArr.length-1] === resultsArr[resultsArr.length-2]) {
          prediction = resultsArr[resultsArr.length-1] === "Red" ? "Green" : "Red";
          output += "<span style='color:#f59e42;font-weight:bold;'>VIP Prediction: Switch detected!</span><br>";
        } else {
          prediction = mostFreq;
          output += "<span style='color:#f59e42;font-weight:bold;'>VIP Prediction: Frequency logic!</span><br>";
        }
        output += "Most frequent result: <b>" + mostFreq + "</b><br>";
        output += "Next result prediction: <b>" + prediction + "</b>";
      }
      outputDiv.innerHTML = output;
    });
    updateResultsDisplay();
  </script>
</body>
</html>
